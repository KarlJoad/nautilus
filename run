#!/bin/bash
if [[ "$*" == *"clean"* ]]; then
  make clean
fi

CROSS_COMPILE=riscv64-unknown-elf-

if [[ "$TOOLCHAIN_OVERRIDE" != "" ]]; then
	CROSS_COMPILE=$TOOLCHAIN_OVERRIDE
fi

ARCH=riscv CROSS_COMPILE=$CROSS_COMPILE make -j V=1

if [[ "$*" == *"qemu"* ]]; then
  echo 'Starting QEMU...'
  printf '%*s\n' "${COLUMNS:-$(tput cols)}" '' | tr ' ' _
  qemu-system-riscv64 -nographic -machine sifive_u -bios default -kernel nautilus.bin -gdb tcp::1234
fi

